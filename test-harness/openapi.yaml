openapi: 3.0.0
info:
  title: web5 SDK test server
  version: 0.3.0
paths:
  /did-ion/create:
    post:
      operationId: did_ion_create
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DIDIonCreateResponse"
  /did-ion/update:
    post:
      operationId: did_ion_update
  /did-ion/recover:
    post:
      operationId: did_ion_recover
  /did-ion/deactivate:
    post:
      operationId: did_ion_deactivate
  /did-ion/resolve:
    post:
      operationId: did_ion_resolve
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DidResolutionRequest"
      responses:
        "200":
          description: the DID resolution result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DidResolutionResult"
  /did-ion/anchor:
    post:
      operationId: did_ion_anchor
  /did-key/create:
    post:
      operationId: did_key_create
  /did-key/resolve:
    post:
      operationId: did_key_resolve
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DidResolutionRequest"
      responses:
        "200":
          description: the DID resolution result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DidResolutionResult"
  /did-jwk/resolve:
    post:
      operationId: did_jwk_resolve
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DidResolutionRequest"
      responses:
        "200":
          description: the DID resolution result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DidResolutionResult"
  /credentials/presentation-exchange:
    post:
      operationId: credential_presentation_exchange
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PresentationExchangeRequest"
        required: true
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StringEncodedData"
  /credentials/issue:
    post:
      operationId: credential_issue
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CredentialIssuanceRequest"
        required: true
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CredentialIssuanceResponse"
  /crypto/generate-key/secp256k1:
    post:
      operationId: crypto_generate_key_secp256k1
  /crypto/generate-key/ed25519:
    post:
      operationId: crypto_generate_key_ed25519
  /crypto/generate-key/secp256r1:
    post:
      operationId: crypto_generate_key_secp256r1
  /crypto/verify/secp256k1:
    post:
      operationId: crypto_verify_secp256k1
  /crypto/verify/ed25519:
    post:
      operationId: crypto_verify_ed25519
  /crypto/verify/secp256r1:
    post:
      operationId: crypto_verify_secp256r1
  /crypto/jose/jws-create:
    post:
      operationId: crypto_jose_jws_create
  /crypto/jose/jws-verify:
    post:
      operationId: crypto_jose_jws_verify
  /crypto/jose/jwk-encode:
    post:
      operationId: crypto_jose_jwk_encode
  /crypto/jose/jwk-decode:
    post:
      operationId: crypto_jose_jwk_decode
  /crypto/jose/jwt-create:
    post:
      operationId: crypto_jose_jwt_create
  /crypto/jose/jwt-verify:
    post:
      operationId: crypto_jose_jwt_verify
  /crypto/key-manager/generate-key:
    post:
      operationId: crypto_key_manager_generate_key
  /crypto/key-manager/import-key:
    post:
      operationId: crypto_key_manager_import_key
  /crypto/key-manager/sign:
    post:
      operationId: crypto_key_manager_sign
  /crypto/key-manager/verify:
    post:
      operationId: crypto_key_manager_verify
  /encoders/base64/encode:
    post:
      operationId: encoders_base64_encode
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StringEncodedData"
        required: true
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StringEncodedData"
  /encoders/base64/decode:
    post:
      operationId: encoders_base64_decode
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StringEncodedData"
        required: true
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StringEncodedData"
  /encoders/base58/encode:
    post:
      operationId: encoders_base58_encode
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StringEncodedData"
        required: true
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StringEncodedData"
  /encoders/base58/decode:
    post:
      operationId: encoders_base58_decode
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StringEncodedData"
        required: true
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StringEncodedData"
  /encoders/sha256/encode:
    post:
      operationId: encoders_sha256_encode
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StringEncodedData"
        required: true
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StringEncodedData"
  /encoders/cbor/encode:
    post:
      operationId: encoders_cbor_encode
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StringEncodedData"
        required: true
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StringEncodedData"
  /encoders/cbor/decode:
    post:
      operationId: encoders_cbor_decode
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/StringEncodedData"
        required: true
      responses:
        "200":
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StringEncodedData"

  /ready:
    get:
      operationId: server_ready
      responses:
        "200":
          description: server is ready
  /shutdown:
    get:
      operationId: server_shutdown
      responses:
        "204":
          description: server will shut down
  /:
    get:
      operationId: identify_self
      responses:
        "200":
          description: information about the test server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TestServerID"
components:
  schemas:
    CredentialIssuanceRequest:
      type: object
      required:
        - credential
        - options
      properties:
        credential:
          $ref: "#/components/schemas/CredentialIssuanceRequestCredential"
        options:
          $ref: "#/components/schemas/CredentialIssuanceRequestOptions"
    CredentialIssuanceRequestCredential:
      type: object
      required:
        - "@context"
        - id
        - type
        - issuer
        - issuanceDate
        - expirationDate
        - credentialSubject
      properties:
        "@context":
          type: array
          items:
            type: string
        id:
          type: string
        type:
          type: array
          items:
            type: string
        issuer:
          type: string
        issuanceDate:
          type: string
        expirationDate:
          type: string
        credentialSubject:
          $ref: "#/components/schemas/CredentialSubject"
    CredentialIssuanceRequestOptions:
      type: object
      required:
        - created
        - challenge
        - domain
        - credentialStatus
      properties:
        created:
          type: string
        challenge:
          type: string
        domain:
          type: string
        credentialStatus:
          $ref: "#/components/schemas/CredentialStatus"
    CredentialIssuer:
      type: object
      required:
        - id
      properties:
        id:
          type: string
    CredentialSubject:
      type: object
      additionalProperties: true
    CredentialStatus:
      type: object
      required:
        - type
      properties:
        type:
          type: string
    CredentialIssuanceResponse:
      type: object
      required:
        - verifiableCredential
      properties:
        verifiableCredential:
          $ref: "#/components/schemas/StringEncodedData"
    VerifiableCredential:
      type: object
      required:
        - "@context"
        - id
        - type
        - issuer
        - issuanceDate
        - expirationDate
        - credentialSubject
        - proof
      properties:
        "@context":
          type: array
          items:
            type: string
        id:
          type: string
        type:
          type: array
          items:
            type: string
        issuer:
          $ref: "#/components/schemas/CredentialIssuer"
        issuanceDate:
          type: string
        expirationDate:
          type: string
        credentialSubject:
          $ref: "#/components/schemas/CredentialSubject"
        proof:
          $ref: "#/components/schemas/CredentialProof"
    CredentialProof:
      type: object
      required:
        - type
        - created
        - challenge
        - domain
        - nonce
        - verificationMethod
        - proofPurpose
        - jws
        - proofValue
      properties:
        type:
          type: string
        created:
          type: string
        challenge:
          type: string
        domain:
          type: string
        nonce:
          type: string
        verificationMethod:
          type: string
        proofPurpose:
          type: string
        jws:
          type: string
        proofValue:
          type: string
    TestServerID:
      type: object
      required:
        - name
        - language
        - url
      properties:
        name:
          type: string
        language:
          type: string
        url:
          type: string
    DIDIonCreateResponse:
      type: object
      required:
        - did
      properties:
        did:
          type: string
    StringEncodedData:
      type: object
      required:
        - data
      properties:
        data:
          type: string
    PresentationExchangeRequest:
      type: object
      properties:
        presentationDefinition:
          $ref: "#/components/schemas/PresentationDefinition"
        vcJwts:
          type: array
          items:
            type: string
    PresentationDefinition:
      type: object
      required:
        - name
        - inputDescriptors
      properties:
        id:
          type: string
        name:
          type: string
        purpose:
          type: string
        submissionRequirements:
          type: array
          items:
            $ref: "#/components/schemas/PresentationDefinitionSubmissionRequirement"
        inputDescriptors:
          type: array
          items:
            $ref: "#/components/schemas/PresentationDefinitionInputDescriptor"
    PresentationDefinitionSubmissionRequirement:
      type: object
      required:
        - rule
      properties:
        name:
          type: string
        purpose:
          type: string
        rule:
          type: string
          enum: [all, pick]
        count:
          type: number
        min:
          type: number
        max:
          type: number
        from:
          type: string
        fromNested:
          type: array
          items:
            $ref: "#/components/schemas/PresentationDefinitionSubmissionRequirement"
    PresentationDefinitionInputDescriptor:
      type: object
      required:
        - id
      properties:
        id:
          type: string
        name:
          type: string
        purpose:
          type: string
        group:
          type: array
          items:
            type: string
        issuance:
          type: array
          items:
            $ref: "#/components/schemas/PresentationDefinitionIssuance"
        constraints:
          $ref: "#/components/schemas/PresentationDefinitionConstraints"
    PresentationDefinitionIssuance:
      type: object
      properties:
        manifest:
          type: string
    PresentationDefinitionConstraints:
      type: object
      properties:
        limitDisclosure:
          type: string
          enum: [required, preferred]
        statuses:
          $ref: "#/components/schemas/PresentationDefinitionStatuses"
        fields:
          type: array
          items:
            $ref: "#/components/schemas/PresentationDefinitionField"
        subjectIsIssuer:
          type: string
          enum: [required, preferred]
        isHolder:
          type: array
          items:
            $ref: "#/components/schemas/PresentationDefinitionHolderSubject"
        sameSubject:
          type: array
          items:
            $ref: "#/components/schemas/PresentationDefinitionHolderSubject"
    PresentationDefinitionHolderSubject:
      type: object
      properties:
        fieldId:
          type: array
          items:
            type: string
        directive:
          type: string
          enum: [required, preferred]
    PresentationDefinitionField:
      type: object
      properties:
        id:
          type: string
        path:
          type: array
          items:
            type: string
        purpose:
          type: string
        filter:
          $ref: "#/components/schemas/PresentationDefinitionFilter"
        predicate:
          type: string
          enum: [required, preferred]
        name:
          type: string
    PresentationDefinitionFilter:
      type: object
      properties:
        const:
          type: string
        enum:
          type: array
          items:
            type: string
        exclusiveMinimum:
          type: string
        exclusiveMaximum:
          type: string
        format:
          type: string
        formatMaximum:
          type: string
        formatMinimum:
          type: string
        formatExclusiveMaximum:
          type: string
        formatExclusiveMinimum:
          type: string
        minLength:
          type: number
        maxLength:
          type: number
        minimum:
          type: string
        maximum:
          type: string
        # not:
        #   type: object # can't do arbitrary key value pairs easily in openapi
        pattern:
          type: string
        type:
          type: string
    PresentationDefinitionStatuses:
      type: object
      properties:
        active:
          $ref: "#/components/schemas/PresentationDefinitionStatus"
        suspended:
          $ref: "#/components/schemas/PresentationDefinitionStatus"
        revoked:
          $ref: "#/components/schemas/PresentationDefinitionStatus"
    PresentationDefinitionStatus:
      type: object
      properties:
        directive:
          type: string
          enum: [required, allowed, disallowed]
    DidResolutionRequest:
      type: object
      externalDocs:
        url: https://www.w3.org/TR/did-core/#did-resolution
      required:
        - did
        - resolutionOptions
      properties:
        did:
          type: string
          externalDocs:
            url: https://www.w3.org/TR/did-core/#did-syntax
        resolutionOptions:
          $ref: "#/components/schemas/DidResolutionOptions"
    DidResolutionOptions:
      type: object
      externalDocs:
        url: https://www.w3.org/TR/did-core/#did-resolution-options
      properties:
        accept:
          type: string
    DidResolutionResult:
      type: object
      externalDocs:
        url: https://www.w3.org/TR/did-core/#did-resolution
      properties:
        didResolutionMetadata:
          $ref: "#/components/schemas/DidResolutionMetadata"
        didDocument:
          $ref: "#/components/schemas/DidDocument"
        didDocumentStream:
          type: string
        didDocumentMetadata:
          $ref: "#/components/schemas/DidDocumentMetadata"
    DidResolutionMetadata:
      type: object
      externalDocs:
        url: https://www.w3.org/TR/did-core/#did-resolution-metadata
      properties:
        contentType:
          type: string
        error:
          type: string
    DidDocument:
      type: object
      externalDocs:
        url: https://www.w3.org/TR/did-core/#did-document-properties
      required:
        - id
      properties:
        id:
          type: string
        alsoKnownAs:
          type: array
          items:
            type: string
        controller:
          oneOf:
            - type: array
              items:
                type: string
        verificationMethod:
          type: array
          items:
            $ref: "#/components/schemas/DidDocumentVerificationMethod"
        authentication:
          type: array
          items:
            $ref: "#/components/schemas/DidDocumentVerificationMethod"
        assertionMethod:
          type: array
          items:
            oneOf:
              - $ref: "#/components/schemas/DidDocumentVerificationMethod"
              - type: string
        keyAgreement:
          type: array
          items:
            oneOf:
              - $ref: "#/components/schemas/DidDocumentVerificationMethod"
              - type: string
        capabilityInvocation:
          type: array
          items:
            oneOf:
              - $ref: "#/components/schemas/DidDocumentVerificationMethod"
              - type: string
        capabilityDelegation:
          type: array
          items:
            oneOf:
              - $ref: "#/components/schemas/DidDocumentVerificationMethod"
              - type: string
        service:
          $ref: "#/components/schemas/DidDocumentService"
    DidDocumentVerificationMethod:
      type: object
      externalDocs:
        url: https://www.w3.org/TR/did-core/#verification-method-properties
      required:
        - id
        - controller
        - type
      properties:
        id:
          type: string
        controller:
          type: string
        type:
          type: string
        publicKeyJwk:
          $ref: "#/components/schemas/JSONWebKey"
        publicKeyMultibase:
          type: string
    JSONWebKey:
      type: object
      externalDocs:
        url: https://www.rfc-editor.org/rfc/rfc7517
      additionalProperties: true
      properties:
        kty:
          type: string
          description: key type
          externalDocs:
            url: https://www.rfc-editor.org/rfc/rfc7517#section-4.1
        use:
          type: string
          description: public key use
          externalDocs:
            url: https://www.rfc-editor.org/rfc/rfc7517#section-4.2
        key_ops:
          type: array
          items:
            type: string
          description: key operations
          externalDocs:
            url: https://www.rfc-editor.org/rfc/rfc7517#section-4.3
        alg:
          type: string
          description: algorithm
          externalDocs:
            url: https://www.rfc-editor.org/rfc/rfc7517#section-4.4
        kid:
          type: string
          description: key ID
          externalDocs:
            url: https://www.rfc-editor.org/rfc/rfc7517#section-4.5
    DidDocumentService:
      type: object
      externalDocs:
        url: https://www.w3.org/TR/did-core/#service-properties
      properties:
        id:
          type: string
        type:
          type: string
        serviceEndpoint:
          description: spec has some alternative formats listed as well that we should support
          type: string
    DidDocumentMetadata:
      type: object
      externalDocs:
        url: https://www.w3.org/TR/did-core/#metadata-structure
      additionalProperties: true
